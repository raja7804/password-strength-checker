import re
import random
import string

# List of very common weak passwords to block
COMMON_PASSWORDS = [
    "123456", "password", "123456789", "qwerty", "abc123",
    "password123", "111111", "123123", "admin", "letmein"
]

def generate_strong_password(length=12):
    # Characters to use for password generation
    characters = string.ascii_letters + string.digits + string.punctuation
    return ''.join(random.choice(characters) for _ in range(length))

def password_strength(password):
    suggestions = []
    
    # Block common passwords immediately
    if password.lower() in COMMON_PASSWORDS:
        return "Very Weak ❌", ["This password is too common! Please use a unique password."]
    
    # Criteria checks
    length = len(password) >= 8
    upper = re.search(r"[A-Z]", password) is not None
    lower = re.search(r"[a-z]", password) is not None
    digit = re.search(r"[0-9]", password) is not None
    special = re.search(r"[!@#$%^&*(),.?\":{}|<>]", password) is not None

    score = sum([length, upper, lower, digit, special])

    # Suggestions
    if not length:
        suggestions.append("• Use at least 8 characters.")
    if not upper:
        suggestions.append("• Add uppercase letters (A-Z).")
    if not lower:
        suggestions.append("• Add lowercase letters (a-z).")
    if not digit:
        suggestions.append("• Include numbers (0-9).")
    if not special:
        suggestions.append("• Use special characters (!@#$%^&* etc).")

    # Strength evaluation
    if score == 5:
        strength = "Very Strong 💪"
    elif score == 4:
        strength = "Strong 🙂"
    elif score == 3:
        strength = "Moderate 😐"
    elif score == 2:
        strength = "Weak 😟"
    else:
        strength = "Very Weak ❌"
    
    return strength, suggestions

# Main program
if __name__ == "__main__":
    while True:
        print("\n🔐 PASSWORD SECURITY TOOL")
        print("1️⃣ Check Password Strength")
        print("2️⃣ Generate Strong Password")
        print("3️⃣ Exit")
        choice = input("\nSelect an option (1/2/3): ")

        if choice == "1":
            user_password = input("\nEnter a password to check: ")
            strength, suggestions = password_strength(user_password)
            print("\nPassword Strength:", strength)
            
            if suggestions:
                print("\nSuggestions to improve:")
                for s in suggestions:
                    print(s)
            else:
                print("✅ Your password is strong! No suggestions needed.")

        elif choice == "2":
            length = int(input("\nEnter desired password length (min 8): "))
            if length < 8:
                print("❗ Minimum length is 8. Setting to 8.")
                length = 8
            print("\n🧪 Generated Strong Password:")
            print(generate_strong_password(length))

        elif choice == "3":
            print("\n👋 Exiting... Stay Secure!")
            break

        else:
            print("\n❌ Invalid choice. Try again.")
